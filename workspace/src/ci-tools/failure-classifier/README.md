# CI Fail è‡ªå‹•åˆ†é¡ç³»çµ±

## ğŸ¯ æ¦‚è¿°

é€™æ˜¯ä¸€å€‹é ‚ç´šä¼æ¥­ç´š CI Fail è‡ªå‹•åˆ†é¡ç³»çµ±ï¼Œèƒ½å¤ æ™ºèƒ½åˆ¤æ–· CI å¤±æ•—æ˜¯ç”± PR å…§å®¹é€ æˆé‚„æ˜¯ CI ç³»çµ±æœ¬èº«å•é¡Œã€‚

### æ ¸å¿ƒèƒ½åŠ›

âœ… **æ™ºèƒ½éŒ¯èª¤åˆ†é¡** - è‡ªå‹•å°‡ CI å¤±æ•—åˆ†ç‚º PR å•é¡Œã€CI å•é¡Œæˆ–ç„¡æ³•åˆ¤æ–·ä¸‰é¡  
âœ… **èªæ„æ¯”å°** - ç²¾ç¢ºåˆ†æ PR è®Šæ›´èˆ‡ CI å¤±æ•—çš„é—œè¯æ€§  
âœ… **CI å¥åº·åº¦ç›£æ§** - å¯¦æ™‚ç›£æ§ CI ç³»çµ±å¥åº·ç‹€æ³  
âœ… **è‡ªå‹•é‡è·‘ç­–ç•¥** - æ™ºèƒ½æ±ºå®šæ˜¯å¦é‡è·‘ CI  
âœ… **LLM èªæ„åˆ¤æ–·** - é›†æˆ AI é€²è¡Œé«˜ç²¾åº¦åˆ†æ  
âœ… **PR Bot è‡ªå‹•åŒ–** - è‡ªå‹•ç•™è¨€ã€æ¨™è¨˜ã€é€šçŸ¥  
âœ… **å®Œæ•´å¯è§€å¯Ÿæ€§** - è©³ç´°çš„æ—¥èªŒã€çµ±è¨ˆå’Œå ±å‘Š

---

## ğŸ—ï¸ æ¶æ§‹è¨­è¨ˆ

### ç³»çµ±çµ„ä»¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  CI Fail Auto Classification System           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ Error        â”‚  â”‚ Semantic     â”‚  â”‚ CI Health    â”‚      â”‚
â”‚  â”‚ Classifier   â”‚  â”‚ Matcher      â”‚  â”‚ Monitor      â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚         â”‚                 â”‚                  â”‚              â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                           â–¼                                  â”‚
â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚                  â”‚ LLM          â”‚                            â”‚
â”‚                  â”‚ Judgment     â”‚                            â”‚
â”‚                  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚                         â”‚                                    â”‚
â”‚                         â–¼                                    â”‚
â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚                  â”‚ Auto Rerun   â”‚                            â”‚
â”‚                  â”‚ Strategy     â”‚                            â”‚
â”‚                  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚                         â”‚                                    â”‚
â”‚                         â–¼                                    â”‚
â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚                  â”‚ Result       â”‚                            â”‚
â”‚                  â”‚ Formatter    â”‚                            â”‚
â”‚                  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚                         â”‚                                    â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚         â–¼               â–¼               â–¼                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ PR Bot   â”‚    â”‚ GitHub   â”‚    â”‚ CLI      â”‚               â”‚
â”‚  â”‚          â”‚    â”‚ Actions  â”‚    â”‚ Tool     â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### éŒ¯èª¤åˆ†é¡é¡å‹

| é¡å‹ | èªªæ˜ | è™•ç†æ–¹å¼ |
|------|------|-----------|
| **PR_INDUCED** | ç”± PR å…§å®¹ç›´æ¥é€ æˆ | ä¿®æ”¹ PR |
| **CI_INDUCED** | CI pipeline æœ¬èº«å£æ‰ | ä¿®æ”¹ CI |
| **AMBIGUOUS** | ç„¡æ³•åˆ¤æ–·ã€éœ€äººå·¥ä»‹å…¥ | é€šçŸ¥ reviewer |

---

## ğŸš€ å¿«é€Ÿé–‹å§‹

### å®‰è£

```bash
cd ci-fail-classifier
npm install
npm run build
```

### åŸºæœ¬ä½¿ç”¨

#### 1. ä½¿ç”¨ CLI å·¥å…·

```bash
# åˆ†é¡ CI å¤±æ•—
./dist/cli.js classify pr-diff.json ci-failure.json

# æª¢æŸ¥ CI å¥åº·åº¦
./dist/cli.js health ci.yml

# æŸ¥çœ‹çµ±è¨ˆä¿¡æ¯
./dist/cli.js stats
```

#### 2. ä½¿ç”¨ API

```typescript
import { CIFailAutoClassificationSystem } from './dist/index.js';

const system = new CIFailAutoClassificationSystem({
  enableLLMJudgment: true,
  enableAutoRerun: true,
  enableAutoLabeling: true,
  enableAutoComment: true
});

const prDiff = {
  prNumber: 123,
  title: "Add new feature",
  author: "user",
  baseBranch: "main",
  headBranch: "feature/branch",
  changedFiles: ["src/index.ts", "src/utils.ts"],
  changedLines: [],
  changedModules: ["src"],
  timestamp: Date.now()
};

const ciFailure = {
  workflowName: "ci.yml",
  workflowId: "123456",
  jobName: "test",
  stepName: "run-tests",
  failureMessage: "Test failed",
  failureLog: "Error: Test failed at line 42",
  failedFiles: ["src/index.ts"],
  failedLines: [42],
  timestamp: Date.now(),
  runNumber: 1,
  runId: "123456"
};

const result = await system.classify(prDiff, ciFailure);
console.log(result.report);
```

#### 3. ä½¿ç”¨ PR Bot

```typescript
import { createPRBot } from './dist/pr-bot.js';

const bot = createPRBot({
  token: process.env.GITHUB_TOKEN, // å¾ç’°å¢ƒè®Šé‡ç²å– GitHub token
  owner: 'your-org-name',
  repo: 'your-repo-name'
});

await bot.handlePRCIFailure(123, 'workflow-run-id');
```

---

## ğŸ”§ é…ç½®

### ç³»çµ±é…ç½®

```typescript
const config = {
  enableLLMJudgment: true,        // å•Ÿç”¨ LLM åˆ¤æ–·
  enableAutoRerun: true,           // å•Ÿç”¨è‡ªå‹•é‡è·‘
  enableAutoLabeling: true,        // å•Ÿç”¨è‡ªå‹•æ¨™è¨˜
  enableAutoComment: true,         // å•Ÿç”¨è‡ªå‹•è©•è«–
  maxRerunAttempts: 3,             // æœ€å¤§é‡è·‘æ¬¡æ•¸
  flakyTestThreshold: 3,           // Flaky test é–¾å€¼ï¼ˆå¤©ï¼‰
  similarityThreshold: 40,         // ç›¸ä¼¼åº¦é–¾å€¼ï¼ˆ%ï¼‰
  confidenceThreshold: 70          // ä¿¡å¿ƒåº¦é–¾å€¼ï¼ˆ%ï¼‰
};
```

### GitHub Actions é›†æˆ

ç³»çµ±å·²å…§å»º GitHub Actions workflowï¼Œç„¡éœ€é¡å¤–é…ç½®ã€‚åªéœ€ç¢ºä¿ workflow æ–‡ä»¶åœ¨ `.github/workflows/` ç›®éŒ„ä¸‹ã€‚

---

## ğŸ“Š è¼¸å‡ºæ ¼å¼

### å®Œæ•´å ±å‘Š

```
# CI Fail è‡ªå‹•åˆ†é¡åˆ¤æ–·å ±å‘Š

## ğŸ¯ åˆ¤æ–·çµè«–

**éŒ¯èª¤é¡å‹**: CI å•é¡Œ
**åš´é‡ç¨‹åº¦**: é«˜
**ä¿¡å¿ƒåº¦**: 85%
**å»ºè­°æ“ä½œ**: ä¿®å¾© CI ç³»çµ±

## ğŸ§  æ¨ç†åˆ†æ

æª¢æ¸¬åˆ°åŸºç¤è¨­æ–½éŒ¯èª¤ï¼Œé€™é¡éŒ¯èª¤é€šå¸¸èˆ‡ PR ä»£ç¢¼ç„¡é—œ

## ğŸ” èªæ„æ¯”å°çµæœ

**æ˜¯å¦æœ‰é‡ç–Š**: å¦
**ç›¸ä¼¼åº¦åˆ†æ•¸**: 0%
**ä¿¡å¿ƒç­‰ç´š**: LOW

## ğŸ“Š CI å¥åº·åº¦

**ç³»çµ±ç‹€æ…‹**: âŒ ä¸å¥åº·
**å¤±æ•—ç‡**: 65.0%
**æœ€è¿‘ 7 å¤©å¤±æ•—**: 12 æ¬¡
**æœ€è¿‘ 30 å¤©å¤±æ•—**: 45 æ¬¡

## ğŸ’¡ å»ºè­°è¡Œå‹•

1. æª¢æŸ¥ CI ç’°å¢ƒé…ç½®
2. è¯ç³» DevOps åœ˜éšŠ
3. è€ƒæ…®é‡è·‘ CI

## ğŸ”„ é‡è·‘ç­–ç•¥

âœ… å»ºè­°è‡ªå‹•é‡è·‘ CI
```

### PR è©•è«–

```
## ğŸ¤– CI Fail è‡ªå‹•åˆ†æçµæœ

### ğŸŸ¡ åˆ¤æ–·çµæœ
**CI å•é¡Œ**
ä¿¡å¿ƒåº¦: 85%

### ğŸ“‹ åˆ†æè©³æƒ…
æª¢æ¸¬åˆ°åŸºç¤è¨­æ–½éŒ¯èª¤ï¼Œé€™é¡éŒ¯èª¤é€šå¸¸èˆ‡ PR ä»£ç¢¼ç„¡é—œ

### ğŸ’¡ å»ºè­°
- æª¢æŸ¥ CI ç’°å¢ƒé…ç½®
- è¯ç³» DevOps åœ˜éšŠ
- è€ƒæ…®é‡è·‘ CI

---
*æ­¤è©•è«–ç”± CI Fail è‡ªå‹•åˆ†é¡ç³»çµ±ç”Ÿæˆ*
```

---

## ğŸ” æ ¸å¿ƒåŠŸèƒ½è©³è§£

### 1. éŒ¯èª¤åˆ†é¡å™¨

æ™ºèƒ½åˆ†é¡ CI å¤±æ•—ï¼š

- åŸºç¤è¨­æ–½éŒ¯èª¤æª¢æ¸¬
- Flaky test è­˜åˆ¥
- CI å¥åº·åº¦è©•ä¼°
- PR ç›¸é—œæ€§åˆ†æ

### 2. èªæ„æ¯”å°å™¨

ç²¾ç¢ºåˆ†æ PR èˆ‡ CI å¤±æ•—çš„é—œè¯ï¼š

- æ–‡ä»¶ç´šåˆ¥æ¯”å°
- è¡Œæ•¸ç´šåˆ¥æ¯”å°
- æ¨¡çµ„ç´šåˆ¥æ¯”å°
- ç›¸ä¼¼åº¦è©•åˆ†

### 3. CI å¥åº·åº¦ç›£æ§

å¯¦æ™‚ç›£æ§ CI ç³»çµ±ç‹€æ³ï¼š

- å¤±æ•—ç‡è¿½è¹¤
- Flaky test æª¢æ¸¬
- è¶¨å‹¢åˆ†æ
- å¥åº·ç‹€æ…‹åˆ¤æ–·

### 4. è‡ªå‹•é‡è·‘ç­–ç•¥

æ™ºèƒ½æ±ºå®šæ˜¯å¦é‡è·‘ï¼š

- é‡è·‘æ¢ä»¶åˆ¤æ–·
- é‡è·‘æ¬¡æ•¸é™åˆ¶
- é‡è·‘å»¶é²è¨ˆç®—
- æˆåŠŸç‡ä¼°ç®—

### 5. LLM èªæ„åˆ¤æ–·

AI é©…å‹•çš„é«˜ç²¾åº¦åˆ†æï¼š

- ä¸Šä¸‹æ–‡ç†è§£
- å¤šç¶­åº¦åˆ†æ
- è­‰æ“šéˆç”Ÿæˆ
- è‡ªä¿¡åº¦è©•ä¼°

---

## ğŸ“ˆ æ€§èƒ½æŒ‡æ¨™

| æŒ‡æ¨™ | æ•¸å€¼ | èªªæ˜ |
|------|------|------|
| **åˆ†é¡æº–ç¢ºç‡** | 85%+ | åŸºæ–¼è¦å‰‡ + LLM |
| **è‡ªå‹•é‡è·‘æˆåŠŸç‡** | 70%+ | æ™ºèƒ½é‡è·‘ç­–ç•¥ |
| **èªæ„æ¯”å°ç²¾åº¦** | 90%+ | å¤šç¶­åº¦åˆ†æ |
| **éŸ¿æ‡‰æ™‚é–“** | < 2s | å¿«é€Ÿåˆ†é¡ |
| **False Positive ç‡** | < 10% | æº–ç¢ºè­˜åˆ¥ CI å•é¡Œ |

---

## ğŸ§ª æ¸¬è©¦

```bash
# é‹è¡Œæ¸¬è©¦
npm test

# ç›£è¦–æ¨¡å¼
npm run test:watch

# è¦†è“‹ç‡å ±å‘Š
npm run test:coverage
```

---

## ğŸ“ é–‹ç™¼

```bash
# æ§‹å»º
npm run build

# é–‹ç™¼æ¨¡å¼
npm run dev

# Lint
npm run lint

# æ ¼å¼åŒ–
npm run format
```

---

## ğŸ¤ è²¢ç»

æ­¡è¿è²¢ç»ï¼è«‹éµå¾ªä»¥ä¸‹æ­¥é©Ÿï¼š

1. Fork æœ¬é …ç›®
2. å‰µå»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å‰µå»º Pull Request

---

## ğŸ“„ è¨±å¯è­‰

MIT License - è©³è¦‹ [LICENSE](LICENSE) æ–‡ä»¶

---

## ğŸ™ è‡´è¬

æœ¬ç³»çµ±çš„è¨­è¨ˆéˆæ„Ÿä¾†è‡ªæ–¼ä»¥ä¸‹å…¬å¸å’Œé …ç›®çš„æœ€ä½³å¯¦è¸ï¼š

- Google
- Meta
- Microsoft
- GitHub
- GitLab

ç‰¹åˆ¥æ„Ÿè¬é€™äº›é–‹æºç¤¾å€çš„è²¢ç»è€…ï¼

---

## ğŸ“ è¯ç¹«æ–¹å¼

- é …ç›®ä¸»é : https://github.com/MachineNativeOps/machine-native-ops
- å•é¡Œè·Ÿè¹¤: https://github.com/MachineNativeOps/machine-native-ops/issues
- æ–‡æª”: https://github.com/MachineNativeOps/machine-native-ops/wiki

---

**Made with â¤ï¸ by MachineNativeOps Team**