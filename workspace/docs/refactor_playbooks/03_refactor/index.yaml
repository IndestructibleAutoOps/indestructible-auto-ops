# 03_refactor Machine-Readable Index
# This file is used by CI/tools/agents to map cluster IDs to refactor playbooks
# 
# Based on the three-phase refactor system architecture:
# 01_deconstruction → 02_integration → 03_refactor
#
# Each cluster entry provides:
# - Traceability to deconstruction and integration playbooks
# - Legacy asset references (via 01_deconstruction/legacy_assets_index.yaml)
# - Governance status for CI/CD automation
# - Priority and status for project management

version: "1.2"
last_updated: "2026-01-19T03:40:00Z"

# Execution Status Summary:
# Phase 1 (core) - In Progress: Documentation completed, awaiting execution
# Phase 2 (scale + meta) - In Progress: Documentation layer integration completed
# Phase 3 (infrastructure) - Pending: Clusters scheduled after Phase 1-2 completion

clusters:
  - cluster_id: "core/architecture-stability"
    domain: "core"
    priority: "P0"                          # P0/P1/P2
    status: "in_progress"                   # draft/in_progress/completed/blocked
    phase: "Phase 1"                        # Current execution phase
    phase_status: "documentation_complete"  # documentation_complete/executing/validating
    
    refactor_file: "core/core__architecture_refactor.md"
    deconstruction_file: "../01_deconstruction/core/core__architecture_deconstruction.md"
    integration_file: "../02_integration/core/core__architecture_integration.md"
    
    legacy_assets:
      - "core-v1-legacy-modules"
      - "core-toplevel-engines-v2.5"
      - "advisory-db-javascript-legacy"
      - "mind-matrix-hypergraph-v1"
      - "unified-integration-monolithic-v2"
    
    involved_dirs:
      - "core/unified_integration/"
      - "core/mind_matrix/"
      - "core/architecture-stability/"
      - "core/safety_mechanisms/"
      - "core/slsa_provenance/"
    
    governance_status:
      violations: 0
      threshold: 5
      auto_fixable: 0
    
    documentation_status:
      deconstruction: "complete"
      integration: "complete"
      refactor: "complete"
    
    last_updated: "2026-01-05"

  - cluster_id: "automation/autonomous"
    domain: "automation"
    priority: "P0"
    status: "draft"
    phase: "Phase 2"                        # Scheduled for Phase 2
    phase_status: "pending"
    refactor_file: "automation/automation__autonomous_refactor.md"
    deconstruction_file: "../01_deconstruction/automation__autonomous_deconstruction.md"
    integration_file: "../02_integration/automation__autonomous_integration.md"
    legacy_assets: []
    involved_dirs:
      - "automation/autonomous/"
    governance_status:
      violations: 0
      threshold: 5
      auto_fixable: 0
    documentation_status:
      deconstruction: "pending"
      integration: "pending"
      refactor: "draft"
    last_updated: "2026-01-05"

  # Future clusters (placeholders)
  - cluster_id: "services/gateway"
    domain: "services"
    priority: "P1"
    status: "pending"
    refactor_file: "services/services__gateway_refactor.md"
    deconstruction_file: "../01_deconstruction/services__gateway_deconstruction.md"
    integration_file: "../02_integration/services__gateway_integration.md"
    legacy_assets: []
    involved_dirs:
      - "services/gateway/"
    governance_status:
      violations: 0
      threshold: 10
      auto_fixable: 0
    last_updated: "2025-12-06"

  - cluster_id: "apps/web"
    domain: "apps"
    priority: "P1"
    status: "pending"
    refactor_file: "apps/apps__web_refactor.md"
    deconstruction_file: "../01_deconstruction/apps__web_deconstruction.md"
    integration_file: "../02_integration/apps__web_integration.md"
    legacy_assets: []
    involved_dirs:
      - "apps/web/"
    governance_status:
      violations: 0
      threshold: 10
      auto_fixable: 0
    last_updated: "2025-12-06"

  - cluster_id: "governance/schemas"
    domain: "governance"
    priority: "P1"
    status: "pending"
    refactor_file: "governance/governance__schemas_refactor.md"
    deconstruction_file: "../01_deconstruction/governance__schemas_deconstruction.md"
    integration_file: "../02_integration/governance__schemas_integration.md"
    legacy_assets: []
    involved_dirs:
      - "governance/schemas/"
    governance_status:
      violations: 0
      threshold: 5
      auto_fixable: 0
    last_updated: "2025-12-06"

  - cluster_id: "tools/scripts"
    domain: "tools"
    priority: "P2"
    status: "pending"
    refactor_file: "tools/tools__scripts_refactor.md"
    deconstruction_file: "../01_deconstruction/tools__scripts_deconstruction.md"
    integration_file: "../02_integration/tools__scripts_integration.md"
    legacy_assets: []
    involved_dirs:
      - "tools/"
    governance_status:
      violations: 0
      threshold: 15
      auto_fixable: 0
    last_updated: "2025-12-06"

  - cluster_id: "src/autonomous/infrastructure/kubernetes"
    domain: "infra"
    priority: "P1"
    status: "pending"
    refactor_file: "src/autonomous/infrastructure/infra__kubernetes_refactor.md"
    deconstruction_file: "../01_deconstruction/infra__kubernetes_deconstruction.md"
    integration_file: "../02_integration/infra__kubernetes_integration.md"
    legacy_assets: []
    involved_dirs:
      - "infrastructure/k8s/"
    governance_status:
      violations: 0
      threshold: 5
      auto_fixable: 0
    last_updated: "2025-12-06"

  - cluster_id: "knowledge/living-kb"
    domain: "knowledge"
    priority: "P2"
    status: "pending"
    refactor_file: "knowledge/knowledge__living_kb_refactor.md"
    deconstruction_file: "../01_deconstruction/knowledge__living_kb_deconstruction.md"
    integration_file: "../02_integration/knowledge__living_kb_integration.md"
    legacy_assets: []
    involved_dirs:
      - "knowledge/"
      - "docs/knowledge-graph.yaml"
    governance_status:
      violations: 0
      threshold: 5
      auto_fixable: 0
    last_updated: "2025-12-06"

  - cluster_id: "meta/documentation"
    domain: "meta"
    priority: "P1"
    status: "in_progress"
    phase: "Phase 2"
    phase_status: "documentation_complete"
    refactor_file: "meta/documentation_refactor.md"
    deconstruction_file: null  # Documentation layer was not deconstructed (already well-structured)
    integration_file: "../02_integration/documentation_integration.md"
    legacy_assets: []
    involved_dirs:
      - "README.md"
      - "README-MACHINE.md"
      - "PROJECT_STATUS.md"
      - "QUICKSTART.md"
      - "SECURITY.md"
      - "todo.md"
      - "workspace/docs/"
    governance_status:
      violations: 0
      threshold: 0  # Root docs must be 100% compliant
      auto_fixable: 0
    documentation_status:
      deconstruction: "not_applicable"  # Already well-structured
      integration: "complete"
      refactor: "complete"
    description: "README.md 集成重構 - 文檔邊界清晰化、自動化更新機制、維護標準化"
    last_updated: "2026-01-19"
