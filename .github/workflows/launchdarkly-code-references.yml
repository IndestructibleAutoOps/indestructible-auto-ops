name: LaunchDarkly Code References

# DISABLED: LaunchDarkly secrets (LD_ACCESS_TOKEN, LD_PROJECT_KEY) are not configured
# To enable: Add the required secrets in repository settings
# See: https://docs.launchdarkly.com/home/code/github-actions

on:
  workflow_dispatch:  # Only manual trigger until secrets are configured
    inputs:
      reason:
        description: 'Reason for manual run'
        required: false
        default: 'Manual trigger'

# Original triggers (disabled until secrets are configured):
# on:
#   push:
#     branches:
#       - main

# Sets permissions for the GITHUB_TOKEN
permissions:
  contents: read

# Cancel in-progress runs for the same workflow
concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

jobs:
  launchDarklyCodeReferences:
    name: LaunchDarkly Code References
    runs-on: ubuntu-latest
    timeout-minutes: 10

    steps:
      - name: Checkout code
        uses: actions/checkout@v6
        with:
          fetch-depth: 11 # Required for lookback configuration to search for unused flags

      - name: LaunchDarkly Code References
        uses: launchdarkly/find-code-references@v2.14.0
        with:
          accessToken: ${{ secrets.LD_ACCESS_TOKEN }}
          projKey: ${{ secrets.LD_PROJECT_KEY }}
