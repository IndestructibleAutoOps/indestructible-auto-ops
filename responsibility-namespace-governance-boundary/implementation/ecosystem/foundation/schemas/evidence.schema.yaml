# Evidence Schema
# @GL-governed
# @GL-layer: GL50-59
# @GL-semantic: evidence-schema
#
# Schema for evidence.yaml files in the governance ecosystem

$schema: "http://json-schema.org/draft-07/schema#"
$id: "https://machine-native-ops.io/schemas/evidence.yaml"
title: "Evidence Schema"
description: "Schema for governance evidence records"

type: object

required:
  - id
  - source
  - timestamp

properties:
  id:
    type: string
    description: "Unique evidence identifier"
    pattern: "^EVD-[A-Z0-9]{8}$"
    examples:
      - "EVD-ABC12345"
  
  source:
    type: string
    description: "Source of the evidence"
    examples:
      - "ecosystem/enforce.py"
      - "ci/build-001"
  
  timestamp:
    type: string
    format: date-time
    description: "Evidence collection timestamp (RFC3339)"
  
  type:
    type: string
    description: "Type of evidence"
    enum:
      - test-result
      - audit-log
      - file-hash
      - manual-review
      - automated-scan
      - deployment-record
  
  rule_id:
    type: string
    description: "Associated rule ID"
    pattern: "^GL\\d{2}-\\d{3}$"
  
  status:
    type: string
    description: "Evidence status"
    enum:
      - valid
      - invalid
      - pending
      - expired
  
  content:
    type: object
    description: "Evidence content"
    properties:
      hash:
        type: string
        description: "Content hash (SHA256)"
        pattern: "^[a-f0-9]{64}$"
      data:
        description: "Evidence data (any type)"
      reference:
        type: string
        description: "Reference to external evidence"
  
  metadata:
    type: object
    description: "Evidence metadata"
    properties:
      collector:
        type: string
        description: "Entity that collected the evidence"
      version:
        type: string
      layer:
        type: string
        pattern: "^GL\\d{2}-\\d{2}$"
      expiry:
        type: string
        format: date-time
        description: "Evidence expiry timestamp"

additionalProperties: false

examples:
  - id: "EVD-ABC12345"
    source: "ecosystem/enforce.py"
    timestamp: "2026-02-03T04:10:00Z"
    type: automated-scan
    rule_id: "GL01-001"
    status: valid
    content:
      hash: "a1b2c3d4e5f6..."
      data:
        files_checked: 100
        violations: 0
    metadata:
      collector: "language-enforcer"
      version: "1.0.0"
      layer: "GL00-09"
