# @GL-semantic: org.mnga.ugs.topology@1.0.0
# @GL-audit-trail: enabled
# UGS Layer 04: Topology Specification
# Defines topology and relationships between governance specifications

spec_id: org.mnga.ugs.topology@1.0.0
spec_type: topology-spec
layer: L04
immutable: true

metadata:
  name: UGS Topology Layer
  version: 1.0.0
  created_at: 2024-02-03T14:00:00Z
  updated_at: 2024-02-03T14:00:00Z
  author: MNGA Governance Team
  description: |
    Defines topology and relationships between governance specifications.
    Provides dependency graph, layer hierarchy, and relationship mapping.

topology_layers:
  # Layer hierarchy
  hierarchy:
    - layer: L00
      name: meta-spec
      description: Meta-governance layer
      parent: null
      immutable: true
    
    - layer: L01
      name: ugs-language
      description: Unified Governance Language
      parent: L00
      immutable: true
    
    - layer: L02
      name: ugs-semantics
      description: Semantic classification
      parent: L01
      immutable: true
    
    - layer: L03
      name: ugs-index
      description: Indexing and lookup
      parent: L02
      immutable: true
    
    - layer: L04
      name: ugs-topology
      description: Topology and relationships
      parent: L03
      immutable: true
    
    - layer: L05-L49
      name: language-extensions
      description: Language layer extensions
      parent: L04
      immutable: false
    
    - layer: L50
      name: ugs-format
      description: Unified format specifications
      parent: L04
      immutable: true
    
    - layer: L51-L99
      name: format-extensions
      description: Format layer extensions
      parent: L50
      immutable: false

topology_relationships:
  # Dependency relationships
  dependencies:
    - source: L01
      target: L00
      type: depends_on
      description: UGS language depends on meta-spec
    
    - source: L02
      target: L01
      type: depends_on
      description: Semantics depends on language
    
    - source: L03
      target: L02
      type: depends_on
      description: Index depends on semantics
    
    - source: L04
      target: L03
      type: depends_on
      description: Topology depends on index
    
    - source: L50
      target: L04
      type: depends_on
      description: Format depends on topology
    
    - source: L05-L49
      target: L04
      type: extends
      description: Language extensions extend topology
    
    - source: L51-L99
      target: L50
      type: extends
      description: Format extensions extend format

  # Reference relationships
  references:
    - source: L01
      target: L00
      type: references
      description: Language references meta-spec definitions
    
    - source: L02
      target: L01
      type: references
      description: Semantics references language tokens
    
    - source: L03
      target: L02
      type: references
      description: Index references semantic classes
    
    - source: L04
      target: L03
      type: references
      description: Topology references index structure

topology_constraints:
  # Circular dependency prevention
  circular_dependency_prevention:
    enabled: true
    algorithm: depth_first_search
    action: reject
    description: Prevent circular dependencies between layers

  # Layer immutability
  layer_immutability:
    immutable_layers:
      - L00
      - L01
      - L02
      - L03
      - L04
      - L50
    description: Core layers are immutable

  # Dependency depth
  dependency_depth:
    max_depth: 10
    description: Maximum allowed dependency depth
    action: warn

topology_validation:
  rules:
    - id: TOP_VAL_001
      name: layer_hierarchy_valid
      description: Layer hierarchy must be valid
      severity: error
      rule: |
        Every layer must have a valid parent layer
        (except L00 which has no parent).
    
    - id: TOP_VAL_002
      name: no_circular_dependencies
      description: No circular dependencies allowed
      severity: error
      rule: |
        Dependency graph must be acyclic.
        Circular dependencies are not allowed.
    
    - id: TOP_VAL_003
      name: immutable_layer_protection
      description: Immutable layers cannot be modified
      severity: error
      rule: |
        Immutable layers (L00-L04, L50) cannot be
        modified after initial creation.
    
    - id: TOP_VAL_004
      name: dependency_depth_valid
      description: Dependency depth must be within limits
      severity: warning
      rule: |
        Dependency depth must not exceed maximum
        allowed depth (10).

topology_graph:
  # Graph structure
  nodes:
    - id: L00
      type: layer
      name: meta-spec
      properties:
        immutable: true
        parent: null
    
    - id: L01
      type: layer
      name: ugs-language
      properties:
        immutable: true
        parent: L00
    
    - id: L02
      type: layer
      name: ugs-semantics
      properties:
        immutable: true
        parent: L01
    
    - id: L03
      type: layer
      name: ugs-index
      properties:
        immutable: true
        parent: L02
    
    - id: L04
      type: layer
      name: ugs-topology
      properties:
        immutable: true
        parent: L03
    
    - id: L50
      type: layer
      name: ugs-format
      properties:
        immutable: true
        parent: L04

  edges:
    - source: L01
      target: L00
      type: depends_on
      weight: 1
    
    - source: L02
      target: L01
      type: depends_on
      weight: 1
    
    - source: L03
      target: L02
      type: depends_on
      weight: 1
    
    - source: L04
      target: L03
      type: depends_on
      weight: 1
    
    - source: L50
      target: L04
      type: depends_on
      weight: 1

topology_visualization:
  # Visualization settings
  layout: hierarchical
  direction: top_to_bottom
  node_size: medium
  edge_style: directed
  color_scheme:
    L00: "#FF6B6B"
    L01: "#4ECDC4"
    L02: "#45B7D1"
    L03: "#96CEB4"
    L04: "#FFEAA7"
    L50: "#DDA0DD"

audit_trail:
  created_at: 2024-02-03T14:00:00Z
  created_by: MNGA Governance Team
  version: 1.0.0
  checksum: sha256:pending
  changes:
    - version: 1.0.0
      date: 2024-02-03T14:00:00Z
      author: MNGA Governance Team
      description: Initial version of UGS topology layer