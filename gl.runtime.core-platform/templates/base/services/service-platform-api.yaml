# @GL-governed
# @GL-layer: GL00-09
# @GL-semantic: general-component
# @GL-audit-trail: gl-enterprise-architecture/governance/audit-trails/GL00_09-audit.json
#
# GL Unified Charter Activated
# GL Root Semantic Anchor: gl-enterprise-architecture/governance/GL-ROOT-SEMANTIC-ANCHOR.yaml
# GL Unified Naming Charter: gl-enterprise-architecture/governance/GL-UNIFIED-NAMING-CHARTER.yaml


# GL Runtime Platform API 服務

apiVersion: v1
kind: Service
metadata:
  name: gl-execution-runtime-api-svc
  namespace: team-gl-runtime-base
  labels:
    # Kubernetes 標準標籤
    app.kubernetes.io/name: 'gl-execution-runtime-api'
    app.kubernetes.io/component: 'service'
    app.kubernetes.io/part-of: 'gl-execution-runtime'
    app.kubernetes.io/version: 'v1.0.0'
    app.kubernetes.io/managed-by: 'kubectl'
    
    # 企業治理標籤
    tenant: 'gl-runtime-team'
    cost-center: 'platform-engineering'
    business-unit: 'infrastructure'
    project: 'gl-execution-runtime'
    
    # 操作標籤
    tier: 'core'
    service.type: 'clusterip'
    
  annotations:
    # 描述性註解
    description: 'GL Runtime Platform 核心 API 服務'
    owner: 'platform-team@gl-runtime.io'
    
    # 服務網格註解（如果使用 Istio）
    service.istio.io/canonical-name: 'gl-execution-runtime-api'
    service.istio.io/canonical-revision: 'v1-0-0'
    
    # 負載均衡器註解（如果使用 AWS ALB/NLB）
    # service.beta.kubernetes.io/aws-load-balancer-type: 'nlb'
    # service.beta.kubernetes.io/aws-load-balancer-cross-zone-load-balancing-enabled: 'true'
    
spec:
  type: ClusterIP
  sessionAffinity: ClientIP
  sessionAffinityConfig:
    clientIP:
      timeoutSeconds: 10800
  selector:
    app.kubernetes.io/name: 'gl-execution-runtime-api'
    app.kubernetes.io/component: 'api-server'
  ports:
  - name: http
    port: 3000
    targetPort: http
    protocol: TCP
  - name: metrics
    port: 9090
    targetPort: metrics
    protocol: TCP