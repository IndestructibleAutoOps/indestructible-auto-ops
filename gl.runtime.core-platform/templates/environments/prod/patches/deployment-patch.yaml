# @GL-governed
# @GL-layer: GL00-09
# @GL-semantic: general-component
# @GL-audit-trail: gl-enterprise-architecture/governance/audit-trails/GL00_09-audit.json
#
# GL Unified Charter Activated
# GL Root Semantic Anchor: gl-enterprise-architecture/governance/GL-ROOT-SEMANTIC-ANCHOR.yaml
# GL Unified Naming Charter: gl-enterprise-architecture/governance/GL-UNIFIED-NAMING-CHARTER.yaml


# 生產環境部署補丁

apiVersion: apps/v1
kind: Deployment
metadata:
  name: gl-execution-runtime-api-deploy-v1
spec:
  template:
    spec:
      containers:
      - name: api-server
        resources:
          requests:
            cpu: '500m'
            memory: '1Gi'
          limits:
            cpu: '2000m'
            memory: '4Gi'
        env:
        - name: NODE_ENV
          value: 'production'
        - name: LOG_LEVEL
          value: 'info'
        - name: DEBUG
          value: 'false'
        livenessProbe:
          httpGet:
            path: /health/live
            port: 3000
          initialDelaySeconds: 30
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
        readinessProbe:
          httpGet:
            path: /health/ready
            port: 3000
          initialDelaySeconds: 10
          periodSeconds: 5
          timeoutSeconds: 3
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: gl-runtime-rest-api-deploy-v1
spec:
  template:
    spec:
      containers:
      - name: rest-api
        resources:
          requests:
            cpu: '300m'
            memory: '512Mi'
          limits:
            cpu: '1500m'
            memory: '2Gi'
        env:
        - name: FLASK_ENV
          value: 'production'
        - name: LOG_LEVEL
          value: 'info'
        - name: DEBUG
          value: 'false'
        livenessProbe:
          httpGet:
            path: /health/live
            port: 8080
          initialDelaySeconds: 30
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
        readinessProbe:
          httpGet:
            path: /health/ready
            port: 8080
          initialDelaySeconds: 10
          periodSeconds: 5
          timeoutSeconds: 3
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: gl-runtime-nlp-control-plane-deploy-v1
spec:
  template:
    spec:
      containers:
      - name: nlp-control-plane
        resources:
          requests:
            cpu: '1000m'
            memory: '2Gi'
          limits:
            cpu: '4000m'
            memory: '8Gi'
        env:
        - name: NODE_ENV
          value: 'production'
        - name: LOG_LEVEL
          value: 'info'
        - name: DEBUG
          value: 'false'
        livenessProbe:
          httpGet:
            path: /health/live
            port: 5001
          initialDelaySeconds: 30
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
        readinessProbe:
          httpGet:
            path: /health/ready
            port: 5001
          initialDelaySeconds: 10
          periodSeconds: 5
          timeoutSeconds: 3
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: gl-runtime-postgres-deploy-v1
spec:
  template:
    spec:
      containers:
      - name: postgres
        resources:
          requests:
            cpu: '1000m'
            memory: '2Gi'
          limits:
            cpu: '4000m'
            memory: '8Gi'