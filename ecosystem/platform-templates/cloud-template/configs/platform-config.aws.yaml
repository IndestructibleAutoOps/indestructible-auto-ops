# AWS Cloud Platform Configuration
# GL Governance Layer: GL10-29 (Operational Layer)

apiVersion: platform.ecosystem/v1
kind: CloudPlatformConfig
metadata:
  name: aws-platform
  version: "1.0.0"
  template: cloud-template
  provider: aws

# Platform Information
platform:
  name: gl.cloud.aws-platform
  display_name: "AWS Cloud Platform"
  type: cloud
  environment: production
  
  cloud:
    provider: aws
    region: us-east-1
    availability_zones:
      - us-east-1a
      - us-east-1b
      - us-east-1c

# AWS Services Configuration
aws:
  # EC2 Configuration
  ec2:
    instance_type: t3.medium
    ami: ami-0c55b159cbfafe1f0  # Amazon Linux 2
    key_pair: platform-key
    security_groups:
      - sg-platform-services
    
  # S3 Configuration
  s3:
    bucket: gl-platform-data-${AWS_ACCOUNT_ID}
    versioning: true
    encryption: AES256
    lifecycle_rules:
      - prefix: logs/
        days: 30
        action: delete
  
  # RDS Configuration
  rds:
    instance_class: db.t3.medium
    engine: postgres
    engine_version: "13.7"
    storage: 100  # GB
    backup_retention: 7
  
  # ELB Configuration
  elb:
    type: application
    scheme: internet-facing
    subnets:
      - subnet-12345
      - subnet-67890
  
  # Auto Scaling
  autoscaling:
    min_size: 2
    max_size: 10
    desired_capacity: 3
    target_cpu: 70

# Service Discovery (using AWS Cloud Map or custom)
service_discovery:
  enabled: true
  provider: aws-cloudmap
  namespace: platform.local
  
# API Gateway (using AWS API Gateway or custom)
api_gateway:
  enabled: true
  provider: custom  # or aws-apigateway
  port: 8000

# Communication (using SQS/SNS or custom)
communication:
  enabled: true
  provider: custom  # or aws-sqs-sns
  
  aws_sqs:
    queue_prefix: platform-
    fifo: false
  
  aws_sns:
    topic_prefix: platform-

# Data Sync (using S3 or custom)
data_sync:
  enabled: true
  primary_storage: s3
  
  s3_sync:
    bucket: gl-platform-sync-${AWS_ACCOUNT_ID}
    prefix: sync/

# Monitoring (CloudWatch)
monitoring:
  cloudwatch:
    enabled: true
    namespace: GL/Platform
    metrics_interval: 60
    log_group: /aws/platform/logs

# Security
security:
  iam:
    instance_role: platform-instance-role
    policies:
      - arn:aws:iam::aws:policy/CloudWatchAgentServerPolicy
      - arn:aws:iam::aws:policy/AmazonS3FullAccess
  
  kms:
    enabled: true
    key_id: ${KMS_KEY_ID}

# Tags
tags:
  Environment: production
  Platform: gl-aws-platform
  ManagedBy: ecosystem
  CostCenter: platform-ops
