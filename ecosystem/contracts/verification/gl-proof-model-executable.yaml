# GL Proof Model v1.0.0 - Executable Contract
# @GL-governed
# @GL-layer: GL90-99
# @GL-semantic: proof-model

version: "1.0.0"
status: "PRODUCTION_READY"
component_type: "DataModel"

# 觸發條件
trigger:
  conditions:
    - type: "report_generation"
      scope: "all"
    - type: "evidence_collection"
      scope: "all"
    - type: "audit_request"
      scope: "all"

# 驗證規則
verify:
  proof_structure:
    - rule: "proof_must_have_id"
      severity: "CRITICAL"
      check: "proof.proof_id exists AND proof.proof_id format_valid"
      remediation: "Generate unique proof ID using UUID format"
    
    - rule: "proof_must_have_claim"
      severity: "CRITICAL"
      check: "proof.claim exists AND proof.claim not_empty"
      remediation: "Provide clear, testable claim"
    
    - rule: "proof_must_have_evidence"
      severity: "CRITICAL"
      check: "proof.evidence exists AND proof.evidence.length >= 1"
      remediation: "Link to verifiable evidence sources"
    
    - rule: "proof_must_have_verification"
      severity: "CRITICAL"
      check: "proof.verification exists AND proof.verification.status_valid"
      remediation: "Run verification and record results"

  evidence_types:
    - type: "source_file"
      required_fields: ["file_path", "line_range", "checksum", "timestamp"]
      validation:
        - "file_path must exist"
        - "checksum must be SHA-256"
        - "line_range must be valid"
    
    - type: "contract_reference"
      required_fields: ["contract_path", "section", "version"]
      validation:
        - "contract_path must be valid"
        - "section must exist in contract"
    
    - type: "validation_output"
      required_fields: ["validator_name", "exit_code", "output", "timestamp"]
      validation:
        - "exit_code must be integer"
        - "timestamp must be ISO 8601"
    
    - type: "reasoning_trace"
      required_fields: ["step_number", "action", "premise", "conclusion"]
      validation:
        - "step_number must be sequential"
        - "premise must reference evidence"

  proof_chains:
    - rule: "chain_must_be_complete"
      severity: "HIGH"
      check: "all_dependencies_satisfied(proof_chain)"
      remediation: "Resolve missing dependencies in proof chain"
    
    - rule: "no_circular_dependencies"
      severity: "CRITICAL"
      check: "not has_circular_references(proof_chain)"
      remediation: "Break circular references in proof chain"

# 審計規則
audit:
  governance_events:
    - event: "proof_created"
      required_fields: ["proof_id", "claim", "evidence_count"]
    
    - event: "proof_verified"
      required_fields: ["proof_id", "verification_status", "timestamp"]
    
    - event: "proof_chain_built"
      required_fields: ["chain_id", "proof_count", "integrity_check"]

  audit_trail:
    - requirement: "all_proofs_must_be_immutable"
      storage: "content_addressable"
      mechanism: "SHA-256 hash addressing"
    
    - requirement: "proof_chain_integrity"
      check: "cryptographic_signature_valid"
      algorithm: "RSA-2048"

# 異常處理策略
fallback:
  on_proof_creation_failure:
    action: "log_error_and_return_default"
    log_level: "ERROR"
    notify: ["governance_manager"]
  
  on_evidence_invalid:
    action: "reject_proof"
    generate_report: true
    suggest_remediation: true
  
  on_chain_verification_failure:
    action: "halt_processing"
    lock_chain: true
    notify: ["governance_manager", "security_team"]

# 合約元數據
metadata:
  created_at: "2026-02-02"
  updated_at: "2026-02-02"
  authors: ["GL-Governance-Team"]
  reviewers: ["GL-Cryptography-Team"]
  dependencies:
    - "ecosystem/contracts/verification/gl-verification-engine-spec.yaml"
  integration_points:
    - "EvidenceCollector.collect()"
    - "ProofBuilder.build()"
    - "ReportGenerator.generate()"