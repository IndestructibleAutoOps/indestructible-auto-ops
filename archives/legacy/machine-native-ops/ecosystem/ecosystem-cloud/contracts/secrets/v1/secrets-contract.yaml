# Cross-Cloud Secrets Contract v1.0.0
# Semantic Anchor: CLOUDPROVIDERABSTRACTION.SECRETS

contract:
  name: CrossCloudSecrets
  version: 1.0.0
  semantic_anchor: CLOUDPROVIDERABSTRACTION.SECRETS
  description: |
    Unified abstraction for cloud secrets management services across all providers.
    Defines the contract that all cloud adapters must implement for secrets operations.
  
  capability:
    - name: create_secret
      input:
        secret_name: string (required)
        secret_value: string (required)
        description: string (optional)
        tags: map[string]string (optional)
        kms_key_id: string (optional)
      output:
        success: boolean
        secret_arn: string
        version_id: string
    
    - name: get_secret_value
      input:
        secret_name: string (required)
        version_id: string (optional)
        version_stage: string (optional)
      output:
        success: boolean
        secret_value: string
        version_id: string
        version_stages: list[string]
        created_date: timestamp
    
    - name: update_secret_value
      input:
        secret_name: string (required)
        secret_value: string (required)
        kms_key_id: string (optional)
      output:
        success: boolean
        version_id: string
        arn: string
    
    - name: delete_secret
      input:
        secret_name: string (required)
        recovery_window_days: integer (optional, default: 30)
        force_delete: boolean (optional, default: false)
      output:
        success: boolean
        deletion_date: timestamp
    
    - name: list_secrets
      input:
        filters: map[string]string (optional)
        max_results: integer (optional, default: 100)
        next_token: string (optional)
      output:
        success: boolean
        secrets: list[SecretInfo]
        next_token: string
    
    - name: rotate_secret
      input:
        secret_name: string (required)
        rotation_lambda_arn: string (required)
        rotation_rules: RotationRules (optional)
      output:
        success: boolean
        arn: string
    
    - name: restore_secret
      input:
        secret_name: string (required)
      output:
        success: boolean
        arn: string

  types:
    SecretInfo:
      name: string
      arn: string
      description: string
      last_changed_date: timestamp
      last_accessed_date: timestamp
      tags: map[string]string
    
    RotationRules:
      automatically_after_days: integer
      duration: string

  validation:
    - name: secret_name_validation
      rule: |
        Secret names must:
        - Be 1-512 characters long
        - Contain only alphanumeric, hyphens, and underscores
        - Not contain "aws" prefix (reserved)
      severity: CRITICAL
    
    - name: secret_value_validation
      rule: |
        Secret values must not exceed 10KB
      severity: HIGH
    
    - name: recovery_window_validation
      rule: |
        Recovery window must be between 7 and 30 days
      severity: MEDIUM
    
    - name: rotation_interval_validation
      rule: |
        Automatic rotation must be at least 1 day apart
      severity: LOW

  adapter_requirements:
    - Adapter must implement all capability methods
    - Adapter must encrypt secrets at rest by default
    - Adapter must support secret rotation
    - Adapter must support versioning and staging
    - Adapter must handle provider-specific secret formats
    - Adapter must provide audit logging for secret access
    - Adapter must never log secret values
  
  compatibility:
    aws_secrets_manager:
      implements: full
      notes: AWS Secrets Manager is the reference implementation
    azure_key_vault:
      implements: full
      notes: Fully compatible
    gcp_secret_manager:
      implements: full
      notes: Fully compatible
    vault:
      implements: full
      notes: HashiCorp Vault, popular on-premise option