# @GL-governed
# @GL-layer: governance
# @GL-semantic: federation-trust-model
# @GL-charter-version: 2.0.0
# @GL-audit-trail: ../../engine/governance/GL_SEMANTIC_ANCHOR.json

apiVersion: federation.machinenativeops.io/v1
kind: TrustModel
metadata:
  name: trust-model
  version: "9.0.0"
  created_at: "2026-01-28T00:00:00Z"
  updated_at: "2026-01-30T00:00:00Z"
  layer: "GL90-99"
  owner: "engineering-team"
  annotations:
    governance.machinenativeops.io/classification: "internal"
    governance.machinenativeops.io/approval: "approved"
    governance.machinenativeops.io/charter-version: "2.0.0"
    governance.machinenativeops.io/semantic-enabled: "true"

spec:
  trust_levels:
    - id: "high"
      name: "High Trust"
      description: "Full trust with automatic operations"
      semantic_validation_required: true
      semantic_compliance_threshold: 100
      auto_repair_enabled: true
      auto_deploy_enabled: true
      approval_required: false
      signing_required: true
      semantic_verification_required: true

    - id: "medium"
      name: "Medium Trust"
      description: "Partial trust with approval required"
      semantic_validation_required: true
      semantic_compliance_threshold: 90
      auto_repair_enabled: false
      auto_deploy_enabled: false
      approval_required: true
      signing_required: true
      semantic_verification_required: true

    - id: "low"
      name: "Low Trust"
      description: "Manual operations only"
      semantic_validation_required: true
      semantic_compliance_threshold: 80
      auto_repair_enabled: false
      auto_deploy_enabled: false
      approval_required: true
      signing_required: true
      semantic_verification_required: true

  semantic_trust_validation:
    enabled: true
    validation_rules:
      - id: "semantic-compliance-check"
        name: "Semantic Compliance Check"
        enabled: true
        description: "Verify semantic compliance with GL standards"
        check_type: "semantic"
        severity: "critical"
        action: "block"

      - id: "semantic-anchor-validation"
        name: "Semantic Anchor Validation"
        enabled: true
        description: "Validate semantic anchors are present and correct"
        check_type: "semantic"
        severity: "critical"
        action: "block"

      - id: "gl-layer-consistency-check"
        name: "GL Layer Consistency Check"
        enabled: true
        description: "Ensure GL layers are consistent across dependencies"
        check_type: "semantic"
        severity: "high"
        action: "warn"

      - id: "semantic-dependency-validation"
        name: "Semantic Dependency Validation"
        enabled: true
        description: "Validate semantic dependencies are valid"
        check_type: "semantic"
        severity: "high"
        action: "warn"

      - id: "schema-inference-validation"
        name: "Schema Inference Validation"
        enabled: true
        description: "Validate inferred schemas match actual content"
        check_type: "semantic"
        severity: "medium"
        action: "warn"

      - id: "dag-consistency-validation"
        name: "DAG Consistency Validation"
        enabled: true
        description: "Validate DAG consistency across federation"
        check_type: "dag"
        severity: "critical"
        action: "block"

      - id: "dag-dependency-validation"
        name: "DAG Dependency Validation"
        enabled: true
        description: "Validate DAG dependencies are resolved"
        check_type: "dag"
        severity: "critical"
        action: "block"

      - id: "dag-execution-authorization"
        name: "DAG Execution Authorization"
        enabled: true
        description: "Authorize DAG execution based on trust level"
        check_type: "dag"
        severity: "critical"
        action: "block"

  permission_matrix:
    repair:
      high: "automatic"
      medium: "approval_required"
      low: "manual_only"

    deploy:
      high: "automatic"
      medium: "manual_only"
      low: "manual_only"

    orchestrate:
      high: "automatic"
      medium: "automatic"
      low: "approval_required"

    audit:
      high: "automatic"
      medium: "automatic"
      low: "automatic"

    semantic_analysis:
      high: "automatic"
      medium: "automatic"
      low: "automatic"

    dag_build:
      high: "automatic"
      medium: "read_only"
      low: "denied"

    dag_execute:
      high: "automatic"
      medium: "approval_required"
      low: "denied"

    dag_resolve:
      high: "automatic"
      medium: "read_only"
      low: "denied"

  semantic_signing:
    enabled: true
    algorithm: "ECDSA-P256"
    key_rotation_days: 90
    signing_requirements:
      - artifact_type: "semantic-analysis"
        signing_required: true
        trust_requirement: "medium"
      - artifact_type: "semantic-classification"
        signing_required: true
        trust_requirement: "medium"
      - artifact_type: "gl-mapping"
        signing_required: true
        trust_requirement: "medium"
      - artifact_type: "semantic-fix-patch"
        signing_required: true
        trust_requirement: "high"
      - artifact_type: "semantic-pr"
        signing_required: true
        trust_requirement: "high"

  semantic_verification:
    enabled: true
    verification_rules:
      - id: "verify-semantic-signatures"
        name: "Verify Semantic Signatures"
        enabled: true
        description: "Verify all semantic artifacts are properly signed"
        check_type: "signature"
        severity: "critical"
        action: "block"

      - id: "verify-semantic-consistency"
        name: "Verify Semantic Consistency"
        enabled: true
        description: "Verify semantic consistency across artifacts"
        check_type: "semantic"
        severity: "high"
        action: "warn"

      - id: "verify-gl-compliance"
        name: "Verify GL Compliance"
        enabled: true
        description: "Verify all semantic artifacts comply with GL standards"
        check_type: "governance"
        severity: "critical"
        action: "block"

  cross_org_trust:
    enabled: true
    trust_propagation:
      - from: "org-001"
        to: "org-002"
        level: "medium"
        semantic_validation_required: true

    semantic_trust_requirements:
      - org_id: "org-001"
        required_semantic_compliance: 100
        required_trust_level: "high"
        semantic_signing_required: true

      - org_id: "org-002"
        required_semantic_compliance: 90
        required_trust_level: "medium"
        semantic_signing_required: true

  provenance:
    enabled: true
    track_semantic_provenance: true
    provenance_data:
      - "semantic_analysis_timestamp"
      - "semantic_analyzer_version"
      - "semantic_graph_version"
      - "gl_charter_version"
      - "classification_confidence"
      - "mapping_confidence"
      - "schema_inference_confidence"
      - "intent_resolution_priority"

  revocation:
    enabled: true
    semantic_violation_threshold: 10
    revocation_actions:
      - trigger: "semantic_compliance_below_threshold"
        action: "revoke_auto_repair_permissions"
        severity: "high"

      - trigger: "semantic_signature_verification_failed"
        action: "block_operation"
        severity: "critical"

      - trigger: "semantic_dependency_conflict"
        action: "warn_and_flag_for_review"
        severity: "medium"

status:
  phase: "configured"
  semantic_trust_validation_enabled: true
  conditions:
    - type: "SemanticTrustValidationEnabled"
      status: "True"
      message: "Semantic trust validation is enabled"
    - type: "SemanticSigningConfigured"
      status: "True"
      message: "Semantic signing is configured"
    - type: "SemanticVerificationEnabled"
      status: "True"
      message: "Semantic verification is enabled"