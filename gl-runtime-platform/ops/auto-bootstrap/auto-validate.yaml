// @GL-governed
// @GL-layer: GL70-89
// @GL-semantic: runtime-general-purpose
// @GL-charter-version: 2.0.0
// @GL-audit-trail: ../../engine/governance/GL_SEMANTIC_ANCHOR.json

# @GL-governed
# @GL-layer: GL90-99
# @GL-semantic: auto-bootstrap-configuration
# @GL-audit-trail: ../../../engine/governance/GL_SEMANTIC_ANCHOR.json
#
# GL Unified Charter Activated
# Auto-Validate Configuration

apiVersion: bootstrap.machinenativeops.io/v1
kind: AutoValidateConfiguration
metadata:
  name: gl-auto-validate
  version: "1.0.0"
  created_at: "2026-01-28T00:00:00Z"
  layer: "GL90-99"

spec:
  enabled: true
  validation_modes:
    - name: "pre-commit"
      trigger: "git_hook"
      hook: "pre-commit"
      blocking: true
    
    - name: "pre-push"
      trigger: "git_hook"
      hook: "pre-push"
      blocking: true
    
    - name: "continuous"
      trigger: "schedule"
      schedule: "*/10 * * * *"
      blocking: false
    
    - name: "on-demand"
      trigger: "api_call"
      blocking: false

  validation_rules:
    - id: "gl-markers-validation"
      name: "GL Markers Validation"
      type: "annotation"
      priority: 100
      applies_to:
        - "*.js"
        - "*.py"
        - "*.yaml"
        - "*.yml"
        - "*.json"
        - "*.md"
      checks:
        - name: "has_governed_marker"
          required: true
          pattern: "@GL-governed"
        - name: "has_layer_marker"
          required: true
          pattern: "@GL-layer"
        - name: "has_semantic_marker"
          required: true
          pattern: "@GL-semantic"
        - name: "has_audit_trail"
          required: true
          pattern: "@GL-audit-trail"
      severity: "error"
    
    - id: "json-metadata-validation"
      name: "JSON Metadata Validation"
      type: "schema"
      priority: 100
      applies_to:
        - "*.json"
        - "package.json"
      checks:
        - name: "has_gl_metadata"
          required: true
          field: "_gl"
        - name: "metadata_structure"
          required: true
          fields:
            - "governed"
            - "layer"
            - "semantic"
            - "version"
      severity: "error"
    
    - id: "yaml-syntax-validation"
      name: "YAML Syntax Validation"
      type: "syntax"
      priority: 95
      applies_to:
        - "*.yaml"
        - "*.yml"
      checks:
        - name: "valid_yaml"
          required: true
        - name: "no_syntax_errors"
          required: true
      severity: "error"
    
    - id: "layer-compliance-validation"
      name: "Layer Compliance Validation"
      type: "architecture"
      priority: 90
      applies_to:
        - "**/*.js"
        - "**/*.py"
      checks:
        - name: "respect_layer_boundaries"
          required: true
        - name: "no_circular_dependencies"
          required: true
        - name: "proper_import_order"
          required: false
      severity: "warning"
    
    - id: "naming-convention-validation"
      name: "Naming Convention Validation"
      type: "style"
      priority: 85
      applies_to:
        - "*"
      checks:
        - name: "file_names_kebab_case"
          required: true
          extensions: ["yaml", "json", "md"]
        - name: "class_names_pascal_case"
          required: true
          languages: ["javascript", "python"]
        - name: "function_names_camel_case"
          required: false
          languages: ["javascript"]
      severity: "warning"
    
    - id: "semantic-anchor-validation"
      name: "Semantic Anchor Validation"
      type: "reference"
      priority: 95
      applies_to:
        - "*.yaml"
        - "*.yml"
        - "*.md"
      checks:
        - name: "anchor_exists"
          required: true
          path: "engine/governance/GL_SEMANTIC_ANCHOR.json"
        - name: "anchor_accessible"
          required: true
        - name: "anchor_version_match"
          required: true
          version: "2.0.0"
      severity: "error"

  validation_pipelines:
    - name: "strict-validation"
      rules:
        - "gl-markers-validation"
        - "json-metadata-validation"
        - "yaml-syntax-validation"
        - "semantic-anchor-validation"
      fail_on: "any"
      mode: "strict"
    
    - name: "standard-validation"
      rules:
        - "gl-markers-validation"
        - "yaml-syntax-validation"
        - "layer-compliance-validation"
      fail_on: "error"
      mode: "standard"
    
    - name: "linting-validation"
      rules:
        - "naming-convention-validation"
        - "layer-compliance-validation"
      fail_on: "warning"
      mode: "linting"

  auto_fix:
    enabled: true
    rules:
      - id: "auto-add-markers"
        applies_to: "missing_markers"
        severity: ["info", "warning"]
        action: "add_template"
        require_approval: false
      
      - id: "auto-fix-yaml"
        applies_to: "yaml_syntax"
        severity: ["warning"]
        action: "format_yaml"
        require_approval: false

  reporting:
    format: "json"
    detail_level: "verbose"
    include_fix_suggestions: true
    include_code_context: true

  notifications:
    enabled: true
    channels:
      - type: "event-stream"
      - type: "log"
      - type: "slack"
        channel: "#gl-validation"
    events:
      - "validation_started"
      - "validation_passed"
      - "validation_failed"
      - "validation_errors"
      - "validation_warnings"

  monitoring:
    enabled: true
    metrics:
      - "validations_run"
      - "validations_passed"
      - "validations_failed"
      - "errors_found"
      - "warnings_found"
      - "auto_fixes_applied"
    reporting_interval: "hourly"

status:
  phase: "active"
  last_validation: null
  total_validations: 0
  pass_rate: 100
  error_rate: 0
  warning_rate: 0