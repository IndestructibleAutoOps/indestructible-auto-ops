# GL Rule Schema
# @GL-governed
# @GL-layer: GL10-29
# @GL-semantic: rule-schema
#
# Schema for GL governance rules (GL0-99.yaml files)

$schema: "http://json-schema.org/draft-07/schema#"
$id: "https://machine-native-ops.io/schemas/gov-rule.yaml"
title: "GL Rule Schema"
description: "Schema for governance rules in the GL ecosystem"

type: object

required:
  - id
  - rule
  - severity

properties:
  id:
    type: string
    description: "Unique rule identifier"
    pattern: "^GL\\d{2}-\\d{3}$"
    examples:
      - "GL01-001"
      - "GL30-042"
  
  rule:
    type: string
    description: "Human-readable rule statement"
    minLength: 10
    maxLength: 500
  
  severity:
    type: string
    description: "Rule severity level"
    enum:
      - low
      - medium
      - high
      - critical
  
  description:
    type: string
    description: "Detailed description of the rule"
  
  layer:
    type: string
    description: "GL layer this rule belongs to"
    pattern: "^GL\\d{2}-\\d{2}$"
  
  category:
    type: string
    description: "Rule category"
    enum:
      - naming
      - structure
      - security
      - compliance
      - performance
      - documentation
  
  evidence:
    type: object
    description: "Evidence requirements for this rule"
    properties:
      required:
        type: boolean
        default: false
      format:
        type: string
        enum:
          - file-reference
          - test-result
          - audit-log
          - manual-review
  
  remediation:
    type: object
    description: "Remediation guidance"
    properties:
      auto_fix:
        type: boolean
        default: false
      suggestion:
        type: string
      playbook:
        type: string
  
  metadata:
    type: object
    description: "Additional metadata"
    properties:
      created:
        type: string
        format: date-time
      updated:
        type: string
        format: date-time
      author:
        type: string
      version:
        type: string
        pattern: "^\\d+\\.\\d+\\.\\d+$"

additionalProperties: false

examples:
  - id: "GL01-001"
    rule: "All modules must have a gl.meta.json file"
    severity: critical
    layer: "GL00-09"
    category: structure
    description: "Every module in the governance ecosystem must declare its metadata"
    evidence:
      required: true
      format: file-reference
    remediation:
      auto_fix: true
      suggestion: "Create gl.meta.json with required fields"
