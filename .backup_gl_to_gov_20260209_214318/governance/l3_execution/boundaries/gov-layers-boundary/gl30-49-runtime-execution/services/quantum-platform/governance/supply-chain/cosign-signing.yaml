# @GL-layer: GQS-L0
# @GL-governed
# @GL-layer: GL90-99
# @GL-semantic: governance-core
# @GL-audit-trail: gov-enterprise-architecture/governance/audit-trails/GL90_99-audit.json
#
# GL Unified Architecture Governance Framework Activated
# GL Root Semantic Anchor: gov-enterprise-architecture/governance/GL-ROOT-SEMANTIC-ANCHOR.yaml
# GL Unified Naming Charter: gov-enterprise-architecture/governance/GL-UNIFIED-NAMING-CHARTER.yaml


apiVersion: supplychain.machinenativeops.io/v1
kind: CosignSigner
metadata:
  name: gov-quantum-cosign-signer
  namespace: governance
  labels:
    gov-version: v10.0.0
    tier: quantum-supply-chain
spec:
  enabled: true
  version: latest
  
  signing:
    keyType: ecdsa-p256
    keyLocation: ${{ secrets.COSIGN_PRIVATE_KEY }}
    password: ${{ secrets.COSIGN_PASSWORD }}
    
    signTargets:
      - container-images
      - sboms
      - provenance
      - binaries
      
  attestation:
    enabled: true
    annotations:
      - sbom
      - provenance
      - build-info
      
    predicateTypes:
      - slsaprovenance
      - spdx
      - link
      
  verification:
    enabled: true
    verifyOn:
      - pull
      - deploy
      - upgrade
      
    policies:
      - name: require-signature
        severity: critical
        action: block
        
      - name: verify-trust
        severity: critical
        action: block
        trustPolicies:
          - type: keyless
            issuer: https://token.actions.githubusercontent.com
            subject: https://github.com/MachineNativeOps/machine-native-ops/.github/workflows/*
            
  storage:
    signatures:
      type: oci
      registry: ghcr.io
      repository: machinenativeops/signatures
      
  rotation:
    enabled: true
    schedule: "0 0 1 * *"  # Monthly rotation
    notify:
      - platform-team@machinenativeops.com